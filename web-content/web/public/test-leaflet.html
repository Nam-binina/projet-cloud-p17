<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        const map = L.map('map').setView([-18.879, 47.508], 13);
        
        // Try Tile Server first
        const tileLayer = L.tileLayer('http://localhost:8081/tile/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap',
            maxZoom: 20,
            crossOrigin: 'anonymous'
        });

        const fallbackLayer = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '© OpenStreetMap © CARTO',
            maxZoom: 20,
            subdomains: 'abcd'
        });

        tileLayer.on('tileerror', () => {
            console.warn('Tile Server failed, using CartoDB');
            tileLayer.remove();
            fallbackLayer.addTo(map);
        });

        tileLayer.addTo(map);

        // Add test markers
        const locations = [
            { name: 'Location 1', lat: -18.8792, lng: 47.5079 },
            { name: 'Location 2', lat: -18.8650, lng: 47.5200 },
            { name: 'Location 3', lat: -18.8900, lng: 47.5350 }
        ];

        locations.forEach(loc => {
            L.marker([loc.lat, loc.lng])
                .bindPopup(loc.name)
                .addTo(map);
            console.log('Marker added:', loc.name);
        });

        console.log('Map initialized with', locations.length, 'markers');
    </script>
</body>
</html>
